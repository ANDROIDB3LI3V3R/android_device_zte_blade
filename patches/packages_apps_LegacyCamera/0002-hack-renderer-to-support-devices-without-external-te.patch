From 0556d91a392de85f95d8983d10eb543444614bd3 Mon Sep 17 00:00:00 2001
From: Konsta <konsta09@gmail.com>
Date: Tue, 28 Aug 2012 14:02:38 +0300
Subject: [PATCH] hack renderer to support devices without external textures

Original author Ricardo Cerqueira

https://github.com/CyanogenMod/android_packages_apps_Camera/commit/d3613d6cfc27a2ed150b5845fc672624484c4f12

Change-Id: I4d1d3ad44f430cfb973c185e85e3b1e02e656a9b
---
 .../src/mosaic_renderer/SurfaceTextureRenderer.cpp |    4 ++++
 jni/mosaic_renderer_jni.cpp                        |    4 ++++
 2 files changed, 8 insertions(+)

diff --git a/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp b/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp
index 88aac36..0fc592e 100755
--- a/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp
+++ b/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp
@@ -29,7 +29,11 @@ const GLfloat g_vVertices[] = {
 };
 GLushort g_iIndices2[] = { 0, 1, 2, 3 };
 
+#ifdef MISSING_EGL_EXTERNAL_IMAGE
+const int GL_TEXTURE_EXTERNAL_OES_ENUM = 0x0DE1;
+#else
 const int GL_TEXTURE_EXTERNAL_OES_ENUM = 0x8D65;
+#endif
 
 const int VERTEX_STRIDE = 6 * sizeof(GLfloat);
 
diff --git a/jni/mosaic_renderer_jni.cpp b/jni/mosaic_renderer_jni.cpp
index bb01e7f..50312c4 100644
--- a/jni/mosaic_renderer_jni.cpp
+++ b/jni/mosaic_renderer_jni.cpp
@@ -166,7 +166,11 @@ float g_dIdent3x3[] = {
     0.0, 1.0, 0.0,
     0.0, 0.0, 1.0};
 
+#ifdef MISSING_EGL_EXTERNAL_IMAGE
+const int GL_TEXTURE_EXTERNAL_OES_ENUM = 0x0DE1;
+#else
 const int GL_TEXTURE_EXTERNAL_OES_ENUM = 0x8D65;
+#endif
 
 static void printGLString(const char *name, GLenum s) {
     const char *v = (const char *) glGetString(s);
-- 
1.7.9.5

